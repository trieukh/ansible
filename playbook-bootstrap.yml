# Petit playbook
---
- hosts: all
  become: true
  tasks:
  - name: "Create user khanh"
    ansible.builtin.user:
      name: khanh
      state: present
  - name: "Change dir permission"
    ansible.builtin.file:
      path: /home/khanh/.ssh
      state: directory
      owner: khanh
      group: khanh
      mode: '0700'
  - name: "Copy keys"
    ansible.builtin.copy:
      src: /home/vagrant/.ssh/authorized_keys
      dest: /home/khanh/.ssh/authorized_keys
      owner: khanh
      group: khanh
      mode: '0600'
- hosts: all
  remote_user: khanh
  tasks:
  - name: "ping server"
    ping: ~
- hosts: all
  become: true
  tasks:
  - name: "installation paquet"
    package:
     name: 
      - tmux
      - vim-enhanced
      - bash-completion
     state: latest 
    register: etat_packages
  - name: "Copy motd"
    ansible.builtin.copy:
      src: /home/vagrant/ansible/motd
      dest: /etc/motd
  - name: "Fin"
    when: etat_packages is changed
    ansible.builtin.debug:
      msg: bootstrapping termin√© avec install
 

