# Petit playbook
---
- hosts: all
  become: true
  tasks:
  - name: "Create user"
    ansible.builtin.user:
      name: "{{bootstrap_user}}"
      state: present
  - name: "Change dir permission"
    ansible.builtin.file:
      path: "/home/{{bootstrap_user}}/.ssh"
      state: directory
      owner: "{{bootstrap_user}}"
      group: "{{bootstrap_user}}"
      mode: '0700'
  - name: "Copy keys"
    ansible.builtin.copy:
      src: /home/vagrant/.ssh/authorized_keys
      dest: "/home/{{bootstrap_user}}/.ssh/authorized_keys"
      owner: "{{bootstrap_user}}"
      group: "{{bootstrap_user}}"
      mode: '0600'
  - name: "ping server"
    become: false
    ping: ~
    remote_user: "{{bootstrap_user}}"
    when: not ansible_check_mode
- hosts: all
  become: true
  handlers:
    - name: "Message de fin"
      ansible.builtin.debug:
        msg: bootstrapping termin√© avec install
  tasks:
  - name: "installation paquet"
    package:
     name: 
      - tmux
      - vim-enhanced
      - bash-completion
      - tree
     state: latest 
    notify: 
      - Message de fin
  - name: "Copy motd"
    ansible.builtin.copy:
      src: /home/vagrant/ansible/motd
      dest: /etc/motd
    notify: 
      - Message de fin


 

